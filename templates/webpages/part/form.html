[%- USE T8 %]
[%- USE HTML %]
[%- USE LxERP %]
[%- USE L %]
[%- USE P %]
<h1>[% FORM.title %] [% IF SELF.part.id %]: [% HTML.escape(SELF.part.displayable_name) %][% END %]</h1>

[% INCLUDE 'common/flash.html' %]

 <form method="post" id="ic" name="ic" action="controller.pl">

  [% L.hidden_tag('part.part_type'   , SELF.part.part_type) %]
  [% L.hidden_tag('part.id'          , SELF.part.id) %]
  [% L.hidden_tag('last_modification', SELF.part.last_modification) %]

  <div id="ic_tabs" class="tabwidget">
   <ul>
    <li><a href="#basic_data">[% 'Basic Data' | $T8 %]</a></li>
    [%- IF SELF.part.is_assortment %]
    <li><a href="#assortment_tab">[% 'Assortment items' | $T8 %]</a></li>
    [%- END %]
    [%- IF SELF.part.is_assembly %]
    <li><a href="#assembly_tab">[% 'Assembly items' | $T8 %]</a></li>
    <li><a href="controller.pl?action=Assembly/ajax_listcomponents&object_id=[% HTML.url(SELF.part.id) %][% callback_url %]">[% 'Structural Parts List' | $T8 %]</a></li>
    [%- END %]
    [%- IF SELF.part.id %]
    [%- IF INSTANCE_CONF.get_doc_storage %]
    <li><a href="controller.pl?action=File/list&file_type=attachment&object_type=part&object_id=[% SELF.part.id %]">[% 'Attachments' | $T8 %]</a></li>
    <li><a href="controller.pl?action=File/list&file_type=image&object_type=part&object_id=[% SELF.part.id %]">[% 'Images' | $T8 %]</a></li>
    [%- END %]
    [%- END %]
    [% IF SELF.all_languages.size %]
    <li><a href="#translations_tab">[% 'Translations' | $T8 %]</a></li>
    [% END %]
    [%- IF SELF.part.id %]
    <li><a href="controller.pl?action=Assembly/ajax_listassemblies&object_id=[% HTML.url(SELF.part.id) %][% callback_url %]">[% 'Used In Assemblies' | $T8 %]</a></li>
    <li><a href="#sales_price_information">[% 'Price information' | $T8 %]</a></li>
    [%- END %]
    [%- IF SELF.part.id  %]
    <li><a href="#price_rules">[% 'Price Rules' | $T8 %]</a></li>
    [% END %]
    [%- IF CUSTOM_VARIABLES.size %]
    <li><a href="#custom_variables">[% 'Custom Variables' | $T8 %]</a></li>
    [%- END %]
   </ul>

   <div id="basic_data">
   [%- PROCESS 'part/_basic_data.html' %]
   </div>

   [%- IF SELF.part.is_assortment %]
   <div id="assortment_tab">
    [% PROCESS 'part/_assortment.html' id=part.id assortment_id=SELF.part.id %]
   </div>
   [%- END %]

   [%- IF SELF.part.is_assembly %]
   <div id="assembly_tab">
    [% PROCESS 'part/_assembly.html' id=part.id assembly_id=SELF.part.id %]
   </div>
   [%- END %]

   [%- IF SELF.all_languages.size %]
    [% PROCESS 'part/_edit_translations.html' %]
   [%- END %]

   [%- IF SELF.part.id %]
   <div id="sales_price_information">
     [% PROCESS part/_sales_price_information.html id=SELF.part.id %]
   </div>
   [%- END %]

   [%- IF CUSTOM_VARIABLES.size %]
   <div id="custom_variables">
      [%- PROCESS 'part/_cvars.html' %]
   </div>
   [%- END %]

   [%- IF SELF.part.id %]
   <div id='price_rules'>
     <div id='price_rules_customer_report'></div>
     <div id='price_rules_vendor_report'></div>
   </div>
   [%- END %]

</div>

  <p>
  [% IF show_edit_buttons %]
    [% L.button_tag('kivi.Part.save()', LxERP.t8('Save')) %]
    [% IF SELF.part.id %]
    [% L.button_tag('kivi.Part.use_as_new()', LxERP.t8('Use as new')) %]
      [% IF SELF.part.orphaned %]
        [% L.button_tag('kivi.Part.delete()', LxERP.t8('Delete')) %]
      [% END %]
    [% L.button_tag('kivi.Part.open_history_popup()', LxERP.t8('History')) %]
    [% END %]
  [% END %]
  </p>

</form>
